---
title: CPP-File-Operations
date: 2019-03-26 13:21:15
tags:
---

http://c.biancheng.net/c/file/
缓冲和非缓冲文件系统
C语言中文件系统可分为两大类，一种是缓冲文件系统也称为标准文件系统，另一种是非缓冲文件系统。ANSI C 标准中只采用缓冲文件系统。

缓冲文件系统：系统自动为每个打开的文件在内存开辟一块缓冲区，缓冲区的大小一般由系统决定。当程序向文件中输出（写入）数据时，程序先把数据输出到缓冲区，待缓冲区满或数据输出完成后，再把数据从缓冲区输出到文件；当程序从文件输入(读取)数据时，先把数据输入到缓冲区，待缓冲区满或数据输人完成后，再把数据从缓冲区逐个输入到程序。

非缓冲文件系统：系统不自动为打开的文件开辟内存缓冲区，由程序设计者自行设置缓冲区及大小。

程序每一次访问磁盘等外存文件都需要移动磁头来定位磁头扇区，如果程序频繁地访问磁盘文件，会缩短磁盘的寿命，况且速度较慢，与快速的计算机内存处理速度不匹配。

带缓冲区文件系统的好处是减少对磁盘等外存文件的操作次数，先把数据读取（写入）到缓冲区中，相当于把缓冲区中的数据一次性与内存交互，提髙了访问速度和设备利用率。

一般把带缓冲文件系统的输入输出称作标准输入输出（标准 I/O），而非缓冲文件系统的输入输出称为系统输入输出（系统 I/O）。

ANSI C 为正在使用的每个文件分配一个文件信息区，该信息区中包含文件描述信息、 该文件所使用的缓冲区大小及缓冲区位置、该文件当前读写到的位置等基本信息。这些信息保存在一个结构体类型变量中，该结构体类型为 FILE 在 stdio.h 头文件中定义，不允许用户改变。

每个 C 编译系统 stdio.h 文件中的 FILE 定义可能会稍有差别，但均包含文件读写的基本信息。